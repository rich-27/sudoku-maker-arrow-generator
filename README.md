# Arrow Generator

A tool to create arrows for [Sudoku Maker](https://sudokumaker.app/) for use on [SudokuPad](https://sudokupad.app/). It makes use of Sudoku Maker's `Cosmetic lines` element to draw the outline of the arrows, which generates SVG paths on SudokuPad.

The attributes of the elements in the JSON generated by Sudoku Maker are passed directly to the generated SVG paths on Sudokupad, and as such editing the JSON in Sudoku Maker's `Share` dialog allows styling of the resultant paths.

This tool generates JSON used to replace Sudoku Maker's puzzle element data, with some properties replaced in the generated JSON during the sharing to SudokuPad process. To be able to edit the generated JSON on Sudoku Maker, enable advanced tools via:
```
Preferences -> Advanced -> Enable advanced tools
```
For some examples of the use of this arrow tool, see:

| Example | Puzzle | Example `input.json` |
| --- | --- | --- |
| [Basic arrows] | [Pivot Sudoku] by StÃ©phane Bura | [pivot-sudoku.json] |
| [Coloured arrows] | [Pivot Sudoku - Bastille Day Fireworks] by StÃ©phane Bura | [pivot-sudoku-bastille-day-fireworks.json] |
| [Angled arrows] | [Slingshot Sudoku - Ups and Downs] by StÃ©phane Bura | [slingshot-sudoku-ups-and-downs.json] |
| [Multiple styles of angled arrows] | [Polyamarrows Slingshot Sudoku] by StÃ©phane Bura | [polyamarrows-slingshot-sudoku.json] |

[Basic arrows]: https://sudokupad.app/1cia3k2as6
[Coloured arrows]: https://sudokupad.app/p04uc9icuy
[Angled arrows]: https://sudokupad.app/l5arxvf5co
[Multiple styles of angled arrows]: https://sudokupad.app/bw8wi3rr0g

[Pivot Sudoku]: https://logic-masters.de/Raetselportal/Raetsel/zeigen.php?id=0003SB
[Pivot Sudoku - Bastille Day Fireworks]: https://logic-masters.de/Raetselportal/Raetsel/zeigen.php?id=0003UK
[Slingshot Sudoku - Ups and Downs]: https://logic-masters.de/Raetselportal/Raetsel/zeigen.php?id=0003YA
[Polyamarrows Slingshot Sudoku]: https://logic-masters.de/Raetselportal/Raetsel/zeigen.php?id=0003ZW

[pivot-sudoku.json]: example-input/polyamarrows-slingshot-sudoku.json
[pivot-sudoku-bastille-day-fireworks.json]: example-input/pivot-sudoku-bastille-day-fireworks.json
[slingshot-sudoku-ups-and-downs.json]: example-input/slingshot-sudoku-ups-and-downs.json
[polyamarrows-slingshot-sudoku.json]: example-input/polyamarrows-slingshot-sudoku.json

## Usage Instructions

1. Edit `arrow-generator/input.json`:
    - It must be a list of specification objects of the following form:
      ```py
      {
        "colour": r'#[0-9]{6}',
        "grid": list[list[ArrowString]]
      }
      ```
    - Each `ArrowString` in grid represents a cell and must be of the form `''.join(list[ArrowSpecifier])`
      - An `ArrowSpecifier` is composed of one or more `DirectionKeys`
        - See [ArrowSpecifier Syntax](#arrowspecifier-syntax) for details
      - `DirectionKeys` have values from:
        ```py
        Literal['s', 'w', 'e' 'd', 'c', 'x', 'z', 'a', 'q']
        ```
      - Each `DirectionLetter` corresponds to its associated direction, as indicated in the following diagram:
        ```
        +-------+
        | q w e |
        | a s d |
        | z x c |
        +-------+
        ```
2. Run `arrow-generator/arrows.py`.
    - The tool will generate JSON data for each specification in `input.json`.
3. For each resultant JSON file:
    - On Sudoku Maker, create a new `Cosmetic lines` element and replace the JSON in `Edit data as JSON` with the contents of `arrow-generator/output/{arrow colour}/{layer}.json`
4. When using the `Share` menu to open the puzzle in SudokuPad, use `Edit JSON` to apply the following changes:
    - Add a `"fill": {arrow colour}` property to each line object generated with this tool.
      - Find: `"color": "#999f",(\n\s*)"thickness": 1.7`
      - Replace: `"color": "#999f",$1"fill": "#999f",$1"thickness": 1.7`
    - Add a `"stroke-linecap": "square"` property to each arrow object:
      - Find: `"color": "#999f",(\n\s*)"thickness": 4.9`
      - Replace: `"color": "#999f",$1"thickness": 4.9,$1"stroke-linecap": "square"`

## ArrowSpecifier Syntax

This tool supports two types of arrows, the specificiers for each described below:

### Basic Arrows

Small arrows, similar to ðŸ ‰, specified by either:

- A pair of `DirectionKeys` joined with a colon:
  - `f"{DirectionKeys}:{DirectionKeys}"`
  - The `DirectionKeys` correspond to:
    - The position of the arrow within within the cell
    - The direction the arrow
- A single `DirectionLetter`, such as `'w'`
  - Shorthand for arrows pointing away from the centre of the cell

### Angled Arrows

Arrows consisting of a both:

- A line extending from an edge of the cell with one or more angles; and
- A [Basic Arrow](#basic-arrows) tip.

These are specified by either:

- Three or more `DirectionKeys` enclosed within braces, such as `"{qec}"`
  - a
- Two `DirectionKeys` enclosed within braces, such as `{az}`
  - Expands to:
    ```py
    f"{{{key_1}{key_1}{key_2}}}"
    ```
  - Shorthand to represent an arrow with a 90 degree bend at the position represented by the first `DirectionKeys`

> [!Note]
> The tool only currently supports right angles. Specifying arrows with acute or obtuse angles, for instance `"{wsc}"` will result in undefined behaviour.
